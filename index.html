<!doctype html>
<html>
  <head>
	
	<meta charset="utf-8">
    <meta name="description" content="Color Detector">
    <meta name="viewport" content="width=device-width, user-scalable=yes, initial-scale=1, maximum-scale=1">
    <meta name="mobile-web-app-capable" content="yes">
    <meta id="theme-color" name="theme-color" content="#89e3d8">
  
    <title>Color Detection by Abhishek Rai</title>
	<script src="color-thief.umd.js"></script>
	<script src="p5.min.js"></script>
	<script src="p5.dom.min.js"></script>
  </head>
  <body>
    <p><strong>This is an example of color detection on Web.</strong></p>
	<!-- <video id="video" width="0" height="0">Abhishek</video> -->
	<!-- <img id="img" src="dog.jpg"> -->

	<video playsinline autoplay></video>
	<button>Take snapshot</button>
	<canvas id="image_snap"></canvas>
	<script>
	const video = document.querySelector('video');
	const canvas = window.canvas = document.querySelector('canvas');
	canvas.width = 480;
	canvas.height = 360;

	const button = document.querySelector('button');

	const constraints = {
		audio: false,
		video: true
	};

	function handleSuccess(stream) {
	window.stream = stream; // make stream available to browser console
	video.srcObject = stream;
	}

	function handleError(error) {
		console.log('navigator.MediaDevices.getUserMedia error: ', error.message, error.name);
	}

	navigator.mediaDevices.getUserMedia(constraints).then(handleSuccess).catch(handleError);
	
	const colorThief = new ColorThief();
    const img = document.querySelector('canvas');
	button.onclick= function() {
		canvas.width = video.videoWidth;
		canvas.height = video.videoHeight;
		canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);
		colorThief.getColor(img)
		console.log("Button Clicked");
		console.log(colorThief.getColor(img));
	};
	
    /*
	// Make sure image is finished loading
    if (img.complete) {
      colorThief.getColor(img);
	  console.log("complete 1");
    } else {
      //image.addEventListener('load', function() {
      //  colorThief.getColor(img);
      //});

    }*/
	
	</script>
  </body>
</html>